<!DOCTYPE html>
<!-- Project page http://github.com/mrtimuk/sierpinski -->
<html>
<head>
<meta charset="utf-8"/>
<title>Sierpinski Fractals</title>
</head>

<body>
<script type="text/javascript">
// Create a canvas if we can, otherwise use svg
var elem = document.createElement('canvas');
var useSvg = 0;
if (!elem) {
	elem = document.createElement('svg');
	useSvg = 1;
}
elem.setAttribute("id","cont");
elem.width = elem.height = elem.style.width = elem.style.height = 729;
elem.style.float = "left";
document.body.appendChild(elem);
</script>

<div style="float:left; padding: 10px">
	Iterations:<br> 
	<input onkeyup="render()" id="edt_n" value="0" maxLength="2" size="2"/>
	<button onclick="decr()">-</button>
	<button onclick="incr()">+</button>

	<div>
	<br>
	Pattern:<br>
	<input id="c00" type="checkbox" checked="1"/>
	<input id="c01" type="checkbox" checked="1"/>
	<input id="c02" type="checkbox" checked="1"/>
	<br>
	<input id="c10" type="checkbox" checked="1"/>
	<input id="c11" type="checkbox"/>
	<input id="c12" type="checkbox" checked="1"/>
	<br>
	<input id="c20" type="checkbox" checked="1"/>
	<input id="c21" type="checkbox" checked="1"/>
	<input id="c22" type="checkbox" checked="1"/>
	</div>

	<div style="margin-top:150px">
	<a href="http://github.com/mrtimuk/sierpinski" style="color:grey">http://github.com/mrtimuk/sierpinski</a>
	</div>
</div>

<script type="text/javascript">
	var cont = document.getElementById('cont');
	var edt_n = document.getElementById('edt_n');
	
	xmlns = "http://www.w3.org/2000/svg";

	function incr() {
		edt_n.value++;
		render();
	}
	function decr() {
		if (edt_n.value > 0) { edt_n.value--; }
		render();
	}

	var pattern = [[],[],[]];

	function render() {
		var n = edt_n.value;
		var size = cont.width;
		clear();

		for (var j = 0; j < 3; j++){
			for (var i = 0; i < 3; i++) {
				pattern[i][j] = document.getElementById("c"+j+i).checked;
			}
		}

		fractal(0,0,size,cont,n);
	}

	function fractal(x,y,s,c,n) {
		if (n == 0 || s == 1) {
			pixel(x,y,s,c);
		} else {
			s = s/3;
			for (var j = 0; j < 3; j++){
				for (var i = 0; i < 3; i++) {
					if (pattern[i][j]) {
						fractal(x+s*i, y+s*j, s, c, n-1);
					}
				}
			}
		}
	}

	function clear() {
		if (useSvg) {
			cont.innerHTML = '';
		} else {
			var ctx = cont.getContext("2d");
			ctx.imageSmoothingEnabled= false
			ctx.fillStyle = '#fff';
			ctx.fillRect (0,0,cont.width,cont.height);
			ctx.fillStyle = '#008';
		} 
	}

	function pixel(x,y,size,cont) {
		if (useSvg) {
			var rect = document.createElementNS(xmlns, 'rect');
			rect.setAttribute('x', x );
			rect.setAttribute('y', y );
			rect.setAttribute('width', size);
			rect.setAttribute('height', size);
			rect.setAttribute('style', 'fill:rgb(0,0,128);');
			cont.appendChild(rect);
		} else {
			var ctx = cont.getContext("2d");
			ctx.fillRect(x,y,size,size);
		}
	}
</script>
</body>
</html>
